/// <reference types="node" />
import { EventEmitter } from 'events';
import PQueue, { DefaultAddOptions } from 'p-queue';
import { URL } from 'url';
import PriorityQueue from 'p-queue/dist/priority-queue';
export interface CheckOptions {
    concurrency?: number;
    port?: number;
    path: string | string[];
    recurse?: boolean;
    timeout?: number;
    markdown?: boolean;
    linksToSkip?: string[] | ((link: string) => Promise<boolean>);
    serverRoot?: string;
}
export declare enum LinkState {
    OK = "OK",
    BROKEN = "BROKEN",
    SKIPPED = "SKIPPED"
}
export interface LinkResult {
    url: string;
    status?: number;
    state: LinkState;
    parent?: string;
    failureDetails?: {}[];
}
export interface CrawlResult {
    passed: boolean;
    links: LinkResult[];
}
interface CrawlOptions {
    url: URL;
    parent?: string;
    crawl: boolean;
    results: LinkResult[];
    cache: Set<string>;
    checkOptions: CheckOptions;
    queue: PQueue<PriorityQueue, DefaultAddOptions>;
    rootPath: string;
}
export declare const headers: {
    'User-Agent': string;
};
/**
 * Instance class used to perform a crawl job.
 */
export declare class LinkChecker extends EventEmitter {
    /**
     * Crawl a given url or path, and return a list of visited links along with
     * status codes.
     * @param options Options to use while checking for 404s
     */
    check(opts: CheckOptions): Promise<{
        links: LinkResult[];
        passed: boolean;
    }>;
    /**
     * Validate the provided flags all work with each other.
     * @param options CheckOptions passed in from the CLI (or API)
     */
    private processOptions;
    /**
     * Spin up a local HTTP server to serve static requests from disk
     * @param root The local path that should be mounted as a static web server
     * @param port The port on which to start the local web server
     * @param markdown If markdown should be automatically compiled and served
     * @private
     * @returns Promise that resolves with the instance of the HTTP server
     */
    private startWebServer;
    /**
     * Crawl a given url with the provided options.
     * @pram opts List of options used to do the crawl
     * @private
     * @returns A list of crawl results consisting of urls and status codes
     */
    crawl(opts: CrawlOptions): Promise<void>;
}
/**
 * Convenience method to perform a scan.
 * @param options CheckOptions to be passed on
 */
export declare function check(options: CheckOptions): Promise<{
    links: LinkResult[];
    passed: boolean;
}>;
export {};
